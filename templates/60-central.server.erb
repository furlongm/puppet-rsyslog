# This groups remote messages according to hostname.
# note all the log messages are in .log naming scheme.
# This is to help log rotate run weekly
# Messages containing the keyword 'nova' go to nova.log.  This will generate
# some false positives, but not enough to be too worried about

#$AllowedSender UDP, 10.9.0.0/24
#$AllowedSender TCP, 10.9.0.0/24

#*.* @@127.0.0.1:61514
#$template DailyPerHostLogs,"/var/log/remote-syslogs/%HOSTNAME%/messages.log"
#$template DailyPerHostLogs,"/var/log/remote-syslogs/%HOSTNAME%/syslog.log"
#$template DailyPerHostLogs,"/var/log/remote-syslogs/%HOSTNAME%/*.*"
#*.* -?DailyPerHostLogs

# Remote message processing
$template DYNauth,"/var/log/remote-syslog/%HOSTNAME%/auth.log"
$template DYNsyslog,"/var/log/remote-syslog/%HOSTNAME%/syslog.log"
$template DYNcron,"/var/log/remote-syslog/%HOSTNAME%/cron.log"
$template DYNdaemon,"/var/log/remote-syslog/%HOSTNAME%/daemon.log"
$template DYNkern,"/var/log/remote-syslog/%HOSTNAME%/kern.log"
$template DYNlpr,"/var/log/remote-syslog/%HOSTNAME%/lpr.log"
$template DYNmail,"/var/log/remote-syslog/%HOSTNAME%/mail.log"
$template DYNuser,"/var/log/remote-syslog/%HOSTNAME%/user.log"
$template DYNmaili,"/var/log/remote-syslog/%HOSTNAME%/mail.info.log"
$template DYNmailw,"/var/log/remote-syslog/%HOSTNAME%/mail.warn.log"
$template DYNmaile,"/var/log/remote-syslog/%HOSTNAME%/mail.err.log"
$template DYNnewsc,"/var/log/remote-syslog/%HOSTNAME%/news.crit.log"
$template DYNnewse,"/var/log/remote-syslog/%HOSTNAME%/news.err.log"
$template DYNnewsn,"/var/log/remote-syslog/%HOSTNAME%/news.notice.log"
$template DYNdebug,"/var/log/remote-syslog/%HOSTNAME%/debug.log"
$template DYNmessages,"/var/log/remote-syslog/%HOSTNAME%/messages.log"

$template NOVAcompute,"/var/log/remote-syslog/%HOSTNAME%/nova.log"

#$RuleSet remote
# splitting up nova stuff

if $programname contains 'nova' then ?NOVAcompute
& ~

#
# First some standard log files.  Log by facility.
#
auth,authpriv.*			?DYNauth
*.*;auth,authpriv.none		-?DYNsyslog
#cron.*				?DYNcron
daemon.*			-?DYNdaemon
kern.*				-?DYNkern
lpr.*				-?DYNlpr
mail.*				-?DYNmail
user.*				-?DYNuser

#
# Logging for the mail system.  Split it up so that
# it is easy to write scripts to parse these files.
#
mail.info			-?DYNmaili
mail.warn			-?DYNmailw
mail.err			?DYNmaile

#
# Logging for INN news system.
#
news.crit			?DYNnewsc
news.err			?DYNnewse
news.notice			-?DYNnewsn

#
# Some "catch-all" log files.
#
*.=debug;\
	auth,authpriv.none;\
	news.none;mail.none	-?DYNdebug
*.=info;*.=notice;*.=warn;\
	auth,authpriv.none;\
	cron,daemon.none;\
	mail,news.none		-?DYNmessages



$InputRELPServerRun <%= rsyslog_server_port %>
